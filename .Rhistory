var_2 = NA, p_value = NA)
input2 <- input %>% select(x, cat_var[i])
input2
x = "area"
df = dataset
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
input2 <- input %>% select(x, cat_var[i])
out <- chisq.test()
input2 <- input %>% select(x, cat_var[i])
input2
out <- chisq.test(input2[,1], input2[,2])
colnames(input2) = c("x", "y")
input2
out <- chisq.test(input2$x, input2$y)
out
colnames(input2) = c("x", "y")
out <- chisq.test(input2$x, input2$y)
out
output$p_value[i] = out$p.value
output
output$var_2[i] = cat_var[i]
output
cat_var <- c("area", "parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input) == 2){
out <- chisq.test(input2$x, input2$y)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = out$p.value
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
f_cat_var("area", cat_var, dataset)
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(input2$x, input2$y)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = out$p.value
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
f_cat_var("area", cat_var, dataset)
f_cat_var("sexo", cat_var, dataset)
df <- dataset %>% filter(area == "Cali")
f_cat_var("sexo", cat_var, df)
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("sexo", cat_var, df)
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(as.factor(input2$x),
as.factor(input2$y))
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = out$p.value
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("sexo", cat_var, df)
options(scipen = 9999)
f_cat_var("sexo", cat_var, df)
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(as.factor(input2$x),
as.factor(input2$y))
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = round(out$p.value, 4)
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("sexo", cat_var, df)
f_cat_var("sexo", cat_var, dataset)
f_cat_var("edu", cat_var, dataset)
f_cat_var("lugar", cat_var, dataset)
f_cat_var("parent", cat_var, dataset)
f_cat_var("posic", cat_var, dataset)
f_cat_var("cambiar", cat_var, dataset)
f_cat_var("estable", cat_var, dataset)
f_cat_var("medio", cat_var, dataset)
f_cat_var("sintrab", cat_var, dataset)
f_cat_var("n_comp", cat_var, dataset)
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(as.factor(input2$x),
as.factor(input2$y),
simulate.p.value = TRUE)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = round(out$p.value, 4)
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("n_comp", cat_var, dataset)
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(as.factor(input2$x),
as.factor(input2$y),
simulate.p.value = TRUE)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = round(out$p.value, 3)
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("edu", cat_var, dataset)
p <- ggplot(count, aes(area, edu)) + theme_bw() +
geom_point(aes(fill=n, size=n), shape=21)
f_cat_var("sexo", cat_var, dataset)
f_cat_var("sexo", cat_var, dataset)
f_cat_var <- function(x, cat_var, df){
input <- df
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input2 <- input %>% select(x, cat_var[i])
colnames(input2) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(as.factor(input2$x),
as.factor(input2$y),
simulate.p.value = F)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = round(out$p.value, 3)
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
f_cat_var("sexo", cat_var, dataset)
f_cat_var <- function(x, cat_var, df){
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input <- df %>% select(x, cat_var[i])
colnames(input) = c("x", "y")
if(ncol(input2) == 2){
out <- chisq.test(as.factor(input2$x),
as.factor(input2$y),
simulate.p.value = F)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = round(out$p.value, 3)
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("sexo", cat_var, dataset)
f_cat_var("sexo", cat_var, dataset)
f_cat_var <- function(x, cat_var, df){
output <- data.frame(var_1 = rep(x, length(cat_var)),
var_2 = NA, p_value = NA)
for (i in 1:length(cat_var)) {
input <- df %>% select(x, cat_var[i])
colnames(input) = c("x", "y")
if(ncol(input) == 2){
out <- chisq.test(as.factor(input$x),
as.factor(input$y),
simulate.p.value = F)
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = round(out$p.value, 3)
} else {
output$var_1[i] = x
output$var_2[i] = cat_var[i]
output$p_value[i] = NA
}
}
return(output)
}
cat_var <- c("parent",
"edu", "lugar", "posic", "cambiar",
"estable", "medio", "sintrab",
"n_comp", "arl", "caja", "actividad")
df <- dataset %>% filter(area == "Cali")
f_cat_var("sexo", cat_var, dataset)
vec_cat <- c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad")
f_cat_var("sexo", vec_cat, dataset)
f_cat_var("edu", vec_cat, dataset)
f_cat_var("posic", vec_cat, dataset)
f_cat_var("sintrab", vec_cat, dataset)
f_cat_var("arl", vec_cat, dataset)
f_cat_var("caja", vec_cat, dataset)
prueba <- dataset %>% select(c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad"))
prueba
mosaicplot(con1)
mosaicplot(con1, shade = T, las = 2)
mosaicplot(con1, shade = T)
mosaicplot(con1, las = 2)
mosaicplot(con1, las = 2)
# Examinar la tabla de contigencia
con1<-table(dataset$area,dataset$edu)
mosaicplot(con1, las = 2)
mosaicplot(con1, las = 2, shade = 2)
mosaicplot(con1, las = 2, shade = TRUE)
# Crear una funci贸n
n_p <- function(x){
data.frame(n = count(x),
perc = n/sum(n))
}
dataset %>% select(c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad")) %>%
group_by(sexo) %>%
summarise(across(everything(), n_p))
dataset %>% select(c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad")) %>%
group_by(sexo)
# Crear una funci贸n
md_df <- function(x){
data.frame(mean = mean(x, na.rm = T),
sd = sd(x, na.rm = T))
}
table_5 <-  new_dataset %>% group_by(area) %>%
summarise(across(c("edad"), md_df))
table_5 <-  dataset %>% group_by(area) %>%
summarise(across(c("edad"), md_df))
table_5
df <- reshape2::melt(dataset)
df
df <- reshape2::melt(dataset, id.vars = "sexo")
df
df <- reshape2::melt(dataset[c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad")], id.vars = "sexo")
df
df %>%
group_by(sexo) %>%
mutate_at(c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad")], id.vars = "sexo"), funs("percent" = ./sum(.)))
df %>%
group_by(sexo) %>%
mutate_at(c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad"), funs("percent" = ./sum(.)))
dataset %>%
group_by(sexo) %>%
mutate_at(c("sexo", "parent", "edu", "posic",
"estable", "medio", "sintrab", "arl",
"caja", "actividad"), funs("percent" = ./sum(.)))
t1 <- table(dataset$sexo, dataset$edu)
View(t1)
t1
t(t1)
count_prop <- tibble(readRDS("C:/Users/Portatil/Desktop/Curso_EDA_2024_I/M贸dulos/M贸dulo 2/Figuras/count_prop.rds"))
count_prop
count_prop = dataset %>% select(c("parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(name, value, name = 'N') %>%
group_by(sexo,name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
count_prop = dataset %>% select(c("parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(name, value, name = 'N') %>%
group_by(sex,name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
dataset$sexo
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(name, value, name = 'N') %>%
group_by(sexo,name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor))
count_prop
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything())
count_prop
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(sexo, name, value, name = 'N') %>%
group_by(sexo,name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(sexo, name, value, name = 'N') %>%
group_by(sexo,name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
colnames(dataset)
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(sexo, name, value, name = 'N')
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(name, value, name = 'N')
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything())
count_prop
View(count_prop)
count_prop = dataset %>%
group_by(sexo) %>%
summarise(across(everything(), mean))
count_prop = dataset %>%
group_by(sexo) %>%
summarise(across(everything(), proportions, .names = "{.col}_perc")))
count_prop = dataset %>%
group_by(sexo) %>%
summarise(across(everything(), proportions, .names = "{.col}_perc"))
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(name, value, name = 'N') %>%
group_by(name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
count_prop
count_prop = dataset %>% group_by(sexo) %>% select(c("parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = everything()) %>%
dplyr::count(name, value, name = 'N') %>%
group_by(name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
count_prop
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = c("parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad"))
count_prop
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor)) %>%
tidyr::pivot_longer(cols = c("parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
dplyr::count(sexo, name, value, name = 'N') %>%
group_by(name) %>%
mutate(N = N,
Share = prop.table(N) * 100)
count_prop
View(count_prop)
count_prop$name
df <- count_prop %>% filter(name == "edu")
df
sum(df$Share)
count_prop = dataset %>% select(c("sexo","parent",
"edu", "posic", "estable", "medio", "sintrab",
"cotiza_fondo", "arl", "caja",
"actividad")) %>%
mutate(across(.fns = as.factor))
count_prop
